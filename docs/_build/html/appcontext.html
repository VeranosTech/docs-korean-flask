
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ko">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>애플리케이션 컨텍스트 &#8212; Flask Documentation (1.0.x)</title>
    <link rel="stylesheet" href="_static/flask.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="shortcut icon" href="_static/flask-icon.png"/>
    <link rel="index" title="색인" href="genindex.html" />
    <link rel="search" title="검색" href="search.html" />
    <link rel="next" title="The Request Context" href="reqcontext.html" />
    <link rel="prev" title="Pluggable Views" href="views.html" />
  <script>DOCUMENTATION_OPTIONS.URL_ROOT = './';</script>
   
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>탐색</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="전체 색인"
             accesskey="I">색인</a></li>
        <li class="right" >
          <a href="reqcontext.html" title="The Request Context"
             accesskey="N">다음</a> |</li>
        <li class="right" >
          <a href="views.html" title="Pluggable Views"
             accesskey="P">이전</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Flask Documentation (1.0.x)</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-application-context">
<span id="app-context"></span><h1>애플리케이션 컨텍스트<a class="headerlink" href="#the-application-context" title="제목 주소">¶</a></h1>
<p>애플리케이션 컨텍스트는 리퀘스트, 명령줄 커맨드 또는 다른 처리중에 애플리케이션 수준의 데이터를 추적한다. 애플리케이션 자체를 함수에서 공유할 때는 <a class="reference internal" href="api.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal notranslate"><span class="pre">current_app</span></code></a> 또는 <a class="reference internal" href="api.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal notranslate"><span class="pre">g</span></code></a>를 대신 사용한다.</p>
<p>애플리케이션 컨텍스트는 <a class="reference internal" href="reqcontext.html"><span class="doc">The Request Context</span></a>와 비슷한데 이는 리퀘스트 처리중에 리퀘스트 레벨에서 데이터를 추적하기 위한 것이다. 리퀘스트 컨텍스트를 푸시하면 그에 대응하는 애플리케이션 컨텍스트도 같이 푸시된다.</p>
<div class="section" id="purpose-of-the-context">
<h2>컨텍스트의 목적<a class="headerlink" href="#purpose-of-the-context" title="제목 주소">¶</a></h2>
<p><a class="reference internal" href="api.html#flask.Flask" title="flask.Flask"><code class="xref py py-class docutils literal notranslate"><span class="pre">Flask</span></code></a> 애플리케이션 객체는 <a class="reference internal" href="api.html#flask.Flask.config" title="flask.Flask.config"><code class="xref py py-attr docutils literal notranslate"><span class="pre">config</span></code></a> 등의 속성을 가지고 있다. 이 속성은 뷰 또는 <a class="reference internal" href="cli.html"><span class="doc">CLI commands</span></a>에서 접근할 수 있어서 편리하다. 하지만 프로젝트의 다른 모듈에서 <cite>app`</cite> 인스턴스를 임포트하면 순환 임포트 문제가 발생하기 쉽다. 또 <a class="reference internal" href="patterns/appfactories.html"><span class="doc">앱 팩토리 패턴</span></a> 또는 재사용 가능한 <a class="reference internal" href="blueprints.html"><span class="doc">blueprints</span></a> 또는 <a class="reference internal" href="extensions.html"><span class="doc">확장기능</span></a> 등을 작성할 때는 <code class="docutils literal notranslate"><span class="pre">app</span></code> 인스턴스를 임포트하지 않는다.</p>
<p>이러한 경우를 대비하여 플라스크에서는 애플리케이션 컨텍스트라는 것을 사용한다. <code class="docutils literal notranslate"><span class="pre">app</span></code> 객체를 직접 참조하는 게 아니라 현재 상태의 애플리케이션을 참조하는 <a class="reference internal" href="api.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal notranslate"><span class="pre">current_app</span></code></a> 프락시를 사용하는 것이다.</p>
<p>플라스크는 리쿼스크가 올 때마다 자동으로 애플리케이션 컨텍스트를 푸시(push)하여 저장한다. 뷰 함수, 에러 핸들러, 그리고 리쿼스트 중에 불리는 다른 함수들은 <a class="reference internal" href="api.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal notranslate"><span class="pre">current_app</span></code></a>을 통해 이 애플리케이션 컨텍스트를 접근할 수 있다.</p>
<p>또한 <code class="docutils literal notranslate"><span class="pre">&#64;app.cli.command()</span></code> 데코레이터로 등록된 <a class="reference internal" href="api.html#flask.Flask.cli" title="flask.Flask.cli"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Flask.cli</span></code></a> CLI 명령을 사용할 때도 자동으로 애플리케니션 컨텍스트를 푸시(push)하여 저장한다.</p>
</div>
<div class="section" id="lifetime-of-the-context">
<h2>컨텍스트의 생애주기<a class="headerlink" href="#lifetime-of-the-context" title="제목 주소">¶</a></h2>
<p>애플리케이션 컨텍스트는 필요할 때마다 만들어졌다가 사라진다. 플라스크 애플리케이션이 리쿼스트 처리를 시작하는 순간 애플리케이션 컨택스트와 <a class="reference internal" href="reqcontext.html"><span class="doc">request context</span></a>를 푸시(push)하여 저장한다. &quot;리쿼스트 처리가 끝나면 저장된 리쿼스트 컨텍스트와 애플리케이션 컨텍스트가 팝(pop)되어 사라진다.</p>
<p>컨텍스트가 어떻게 동작하는지 그리고 리퀘스트의 전체 생애주기에 대해 자세히 보려면 <a class="reference internal" href="reqcontext.html"><span class="doc">The Request Context</span></a>를 참조한다.</p>
</div>
<div class="section" id="manually-push-a-context">
<h2>컨텍스트를 수동으로 푸시하기<a class="headerlink" href="#manually-push-a-context" title="제목 주소">¶</a></h2>
<p>만약 애플리케이션 컨텍스트 바깥에서 <a class="reference internal" href="api.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal notranslate"><span class="pre">current_app</span></code></a> 데이터에 접근하려면 다음 에러 메세지를 받는다.</p>
<div class="highlight-pytb notranslate"><div class="highlight"><pre><span></span><span class="x">RuntimeError: Working outside of application context.</span>

<span class="x">This typically means that you attempted to use functionality that</span>
<span class="x">needed to interface with the current application object in some way.</span>
<span class="x">To solve this, set up an application context with app.app_context().</span>
</pre></div>
</div>
<p>만약 확장 프로그램 초기화와 같은 애플리케이션 설정 중에 이러한 메세지를 본다면 <code class="docutils literal notranslate"><span class="pre">app</span></code> 객체에 직접 접근했다는 뜻이다.  이 때는 <code class="docutils literal notranslate"><span class="pre">with</span></code> 블럭에서 <a class="reference internal" href="api.html#flask.Flask.app_context" title="flask.Flask.app_context"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app_context()</span></code></a> 메서드로 컨텍스트를 강제로 푸시할 수 있다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_app</span><span class="p">():</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>
        <span class="n">init_db</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">app</span>
</pre></div>
</div>
<p>만약 애플리케이션 설정이 아닌 다른 코드에서 이 에러가 발생하면 해당 코드를 뷰 함수 내부나 CLI 명령 내부로 옮겨야 한다.</p>
</div>
<div class="section" id="storing-data">
<h2>데이터 저장<a class="headerlink" href="#storing-data" title="제목 주소">¶</a></h2>
<p>애플리케이션 컨텍스트는 리퀘스트나 CLI 명령을 처리하는 동안 여러 함수에서 공통을 사용할 데이터를 저장할 수 있는 좋은 곳이다. 플라스크는 이러한 목적으로 <a class="reference internal" href="api.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal notranslate"><span class="pre">g</span> <span class="pre">object</span></code></a>라는 것을 제공한다. 이 객체는 애플리케이션 컨텍스트와 같은 생애주기를 가지는 간단한 네임스페이스 객체다.</p>
<div class="admonition note">
<p class="first admonition-title">주석</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">g</span></code>라는 이름은 &quot;global&quot;을 뜻한다. 하지만 컨텍스트 안에서만 전역일 뿐이다. 컨텍스트가 끝나면 <code class="docutils literal notranslate"><span class="pre">g</span></code> 안의 데이터는 사라진다. 따라서 연속된 리쿼스트와 리쿼스트 사이에서 데이터를 보관할 수 있는 장소는 아니다. 리쿼스트가 끝나고 다음 리쿼스트에서도 쓸 수 있는 데이터를 저장하려면 데이터베이스나 <a class="reference internal" href="api.html#flask.session" title="flask.session"><code class="xref py py-data docutils literal notranslate"><span class="pre">session</span></code></a>을 사용해야 한다.</p>
</div>
<p><a class="reference internal" href="api.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal notranslate"><span class="pre">g</span></code></a>의 일반적인 사용은 리퀘스트 처리중에 리소스를 관리하는 것이다.</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">get_X()</span></code> creates resource <code class="docutils literal notranslate"><span class="pre">X</span></code> if it does not exist, caching it
as <code class="docutils literal notranslate"><span class="pre">g.X</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">teardown_X()</span></code> closes or otherwise deallocates the resource if it
exists. It is registered as a <a class="reference internal" href="api.html#flask.Flask.teardown_appcontext" title="flask.Flask.teardown_appcontext"><code class="xref py py-meth docutils literal notranslate"><span class="pre">teardown_appcontext()</span></code></a>
handler.</li>
</ol>
<p>For example, you can manage a database connection using this pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="k">import</span> <span class="n">g</span>

<span class="k">def</span> <span class="nf">get_db</span><span class="p">():</span>
    <span class="k">if</span> <span class="s1">&#39;db&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
        <span class="n">g</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">connect_to_database</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="n">db</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">teardown_appcontext</span>
<span class="k">def</span> <span class="nf">teardown_db</span><span class="p">():</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>During a request, every call to <code class="docutils literal notranslate"><span class="pre">get_db()</span></code> will return the same
connection, and it will be closed automatically at the end of the
request.</p>
<p>You can use <a class="reference external" href="https://werkzeug.palletsprojects.com/en/0.15.x/local/#werkzeug.local.LocalProxy" title="(in Werkzeug v0.15.x)"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalProxy</span></code></a> to make a new context
local from <code class="docutils literal notranslate"><span class="pre">get_db()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">werkzeug.local</span> <span class="k">import</span> <span class="n">LocalProxy</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">LocalProxy</span><span class="p">(</span><span class="n">get_db</span><span class="p">)</span>
</pre></div>
</div>
<p>Accessing <code class="docutils literal notranslate"><span class="pre">db</span></code> will call <code class="docutils literal notranslate"><span class="pre">get_db</span></code> internally, in the same way that
<a class="reference internal" href="api.html#flask.current_app" title="flask.current_app"><code class="xref py py-data docutils literal notranslate"><span class="pre">current_app</span></code></a> works.</p>
<hr class="docutils" />
<p>If you're writing an extension, <a class="reference internal" href="api.html#flask.g" title="flask.g"><code class="xref py py-data docutils literal notranslate"><span class="pre">g</span></code></a> should be reserved for user
code. You may store internal data on the context itself, but be sure to
use a sufficiently unique name. The current context is accessed with
<a class="reference internal" href="api.html#flask._app_ctx_stack" title="flask._app_ctx_stack"><code class="xref py py-data docutils literal notranslate"><span class="pre">_app_ctx_stack.top</span></code></a>. For more information see
<a class="reference internal" href="extensiondev.html"><span class="doc">Flask Extension Development</span></a>.</p>
</div>
<div class="section" id="events-and-signals">
<h2>Events and Signals<a class="headerlink" href="#events-and-signals" title="제목 주소">¶</a></h2>
<p>The application will call functions registered with
<a class="reference internal" href="api.html#flask.Flask.teardown_appcontext" title="flask.Flask.teardown_appcontext"><code class="xref py py-meth docutils literal notranslate"><span class="pre">teardown_appcontext()</span></code></a> when the application context is
popped.</p>
<p>If <a class="reference internal" href="api.html#flask.signals.signals_available" title="flask.signals.signals_available"><code class="xref py py-data docutils literal notranslate"><span class="pre">signals_available</span></code></a> is true, the following signals are
sent: <a class="reference internal" href="api.html#flask.appcontext_pushed" title="flask.appcontext_pushed"><code class="xref py py-data docutils literal notranslate"><span class="pre">appcontext_pushed</span></code></a>, <a class="reference internal" href="api.html#flask.appcontext_tearing_down" title="flask.appcontext_tearing_down"><code class="xref py py-data docutils literal notranslate"><span class="pre">appcontext_tearing_down</span></code></a>, and
<a class="reference internal" href="api.html#flask.appcontext_popped" title="flask.appcontext_popped"><code class="xref py py-data docutils literal notranslate"><span class="pre">appcontext_popped</span></code></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
  <span id="sidebar-top"></span>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  
    
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/flask-logo-sidebar.png" alt="Logo"/>
            </a></p>
  

  <h3>Contents</h3>
  <ul>
<li><a class="reference internal" href="#">애플리케이션 컨텍스트</a><ul>
<li><a class="reference internal" href="#purpose-of-the-context">컨텍스트의 목적</a></li>
<li><a class="reference internal" href="#lifetime-of-the-context">컨텍스트의 생애주기</a></li>
<li><a class="reference internal" href="#manually-push-a-context">컨텍스트를 수동으로 푸시하기</a></li>
<li><a class="reference internal" href="#storing-data">데이터 저장</a></li>
<li><a class="reference internal" href="#events-and-signals">Events and Signals</a></li>
</ul>
</li>
</ul>
<h3>Navigation</h3>
<ul>
  <li><a href="index.html">Overview</a>
    <ul>
          <li>Previous: <a href="views.html" title="이전 장">Pluggable Views</a>
          <li>Next: <a href="reqcontext.html" title="다음 장">The Request Context</a>
    </ul>
  </li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3>빠른 검색</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="바로 가기" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010 Pallets Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>